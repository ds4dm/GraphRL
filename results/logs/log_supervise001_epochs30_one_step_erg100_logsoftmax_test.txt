nohup: ignoring input
| Xavier Initialization
| Xavier Initialization
Supervised Training started
heuristic: one_step_greedy learning rate: 0.001 epochs: 30 DataSet: ErgDataset

/SCRATCH/liudefen/PycharmProjects/gnn/GraphRL/gcn/models_gcn.py:85: UserWarning: Implicit dimension choice for log_softmax has been deprecated. Change the call to include dim=X as an argument.
  features = F.log_softmax(features.t())
epochs 0 loss 2.223024736359858
epoch 0000 gcn2one_step_greedy  train av_ratio 1.1197492163009404  validation av_ratio 1.0974563285320258
parameter name gc1.weight parameter value tensor(1.00000e-04 *
       [[-1.7558]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-03 *
       [-4.3849], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-05 *
       [[-4.9248]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-9.5907], device='cuda:0')
epochs 1 loss 2.197351608468538
epoch 0001 gcn2one_step_greedy  train av_ratio 1.1045454545454547  validation av_ratio 1.0937787312289304
parameter name gc1.weight parameter value tensor(1.00000e-04 *
       [[-1.6927]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-04 *
       [-1.4524], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-05 *
       [[-4.7475]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-05 *
       [ 1.1241], device='cuda:0')
epochs 2 loss 2.5341070220305975
epoch 0002 gcn2one_step_greedy  train av_ratio 1.1115203761755486  validation av_ratio 1.0982991112473184
parameter name gc1.weight parameter value tensor(1.00000e-04 *
       [[-1.5860]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-07 *
       [-2.8203], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-05 *
       [[-4.4476]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.2699], device='cuda:0')
epochs 3 loss 2.2936060280039365
epoch 0003 gcn2one_step_greedy  train av_ratio 1.1155956112852665  validation av_ratio 1.1013637756665644
parameter name gc1.weight parameter value tensor(1.00000e-04 *
       [[-1.4216]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-12 *
       [-4.4768], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-05 *
       [[-3.9855]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.7028], device='cuda:0')
epochs 4 loss 2.2943936586811597
epoch 0004 gcn2one_step_greedy  train av_ratio 1.1141065830721002  validation av_ratio 1.0979160281949125
parameter name gc1.weight parameter value tensor(1.00000e-04 *
       [[-1.1866]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-21 *
       [-6.4100], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-05 *
       [[-3.3254]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.8884], device='cuda:0')
epochs 5 loss 2.2377510555520113
epoch 0005 gcn2one_step_greedy  train av_ratio 1.1137147335423196  validation av_ratio 1.0984523444682808
parameter name gc1.weight parameter value tensor(1.00000e-05 *
       [[-8.8215]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-40 *
       [ 4.6444], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-05 *
       [[-2.4706]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.7852], device='cuda:0')
epochs 6 loss 2.341555625243431
epoch 0006 gcn2one_step_greedy  train av_ratio 1.1053291536050158  validation av_ratio 1.09707324547962
parameter name gc1.weight parameter value tensor(1.00000e-05 *
       [[-5.4278]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-41 *
       [-1.0653], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-05 *
       [[-1.5185]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.7940], device='cuda:0')
epochs 7 loss 2.341555625243431
epoch 0007 gcn2one_step_greedy  train av_ratio 1.113793103448276  validation av_ratio 1.0964603125957706
parameter name gc1.weight parameter value tensor(1.00000e-05 *
       [[-2.4491]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-41 *
       [ 1.2551], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-06 *
       [[-6.8397]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.8890], device='cuda:0')
epochs 8 loss 2.342343255920654
epoch 0008 gcn2one_step_greedy  train av_ratio 1.1091692789968652  validation av_ratio 1.1005209929512718
parameter name gc1.weight parameter value tensor(1.00000e-06 *
       [[-6.6335]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-42 *
       [ 5.2843], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-06 *
       [[-1.8472]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.9118], device='cuda:0')
epochs 9 loss 2.6303754933610017
epoch 0009 gcn2one_step_greedy  train av_ratio 1.104153605015674  validation av_ratio 1.0957707631014404
parameter name gc1.weight parameter value tensor(1.00000e-07 *
       [[-7.7204]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-42 *
       [-1.5330], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-07 *
       [[-2.1396]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.8310], device='cuda:0')
epochs 10 loss 2.4390528798534925
epoch 0010 gcn2one_step_greedy  train av_ratio 1.106112852664577  validation av_ratio 1.1050413729696598
parameter name gc1.weight parameter value tensor(1.00000e-08 *
       [[-2.1904]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-41 *
       [ 1.7526], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-09 *
       [[-6.0215]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.8658], device='cuda:0')
epochs 11 loss 2.3336221464409883
epoch 0011 gcn2one_step_greedy  train av_ratio 1.1051724137931034  validation av_ratio 1.100674226172234
parameter name gc1.weight parameter value tensor(1.00000e-11 *
       [[-5.6372]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-41 *
       [ 2.2892], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-11 *
       [[-1.5283]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.8204], device='cuda:0')
epochs 12 loss 2.1022540964617784
epoch 0012 gcn2one_step_greedy  train av_ratio 1.1084639498432602  validation av_ratio 1.1012105424456022
parameter name gc1.weight parameter value tensor(1.00000e-15 *
       [[-2.1227]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-41 *
       [-2.1315], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-16 *
       [[-5.6119]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.8018], device='cuda:0')
epochs 13 loss 2.2456774041488226
epoch 0013 gcn2one_step_greedy  train av_ratio 1.1124608150470219  validation av_ratio 1.1034324241495557
parameter name gc1.weight parameter value tensor(1.00000e-23 *
       [[-2.4605]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-42 *
       [ 3.8087], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-24 *
       [[-6.1776]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.8544], device='cuda:0')
epochs 14 loss 2.2952026650741155
epoch 0014 gcn2one_step_greedy  train av_ratio 1.1120689655172413  validation av_ratio 1.1049647563591787
parameter name gc1.weight parameter value tensor(1.00000e-38 *
       [[-9.4350]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-39 *
       [-6.5108], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-37 *
       [[-3.7584]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.7577], device='cuda:0')
epochs 15 loss 2.1981251873507555
epoch 0015 gcn2one_step_greedy  train av_ratio 1.1080721003134797  validation av_ratio 1.1026662580447442
parameter name gc1.weight parameter value tensor(1.00000e-35 *
       [[ 1.1579]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-37 *
       [-1.8738], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-35 *
       [[ 3.6117]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.8006], device='cuda:0')
epochs 16 loss 2.1905146539642866
epoch 0016 gcn2one_step_greedy  train av_ratio 1.110344827586207  validation av_ratio 1.0963070793748084
parameter name gc1.weight parameter value tensor(1.00000e-41 *
       [[ 2.6368]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-41 *
       [-7.0096], device='cuda:0')
parameter name gc2.weight parameter value tensor(1.00000e-41 *
       [[ 9.5667]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-1.8053], device='cuda:0')
epochs 17 loss 1.5365161680677089
epoch 0017 gcn2one_step_greedy  train av_ratio 1.0775862068965518  validation av_ratio 1.0002298498314435
parameter name gc1.weight parameter value tensor([[ 0.1460]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-02 *
       [ 7.1624], device='cuda:0')
parameter name gc2.weight parameter value tensor([[-0.1457]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-05 *
       [ 2.0391], device='cuda:0')
epochs 18 loss 0.17516763866997964
epoch 0018 gcn2one_step_greedy  train av_ratio 1.0051724137931033  validation av_ratio 0.9981612013484523
parameter name gc1.weight parameter value tensor([[ 0.2127]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-02 *
       [ 3.4987], device='cuda:0')
parameter name gc2.weight parameter value tensor([[-0.2120]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [ 4.4190], device='cuda:0')
epochs 19 loss 0.0959498261206626
epoch 0019 gcn2one_step_greedy  train av_ratio 1.00282131661442  validation av_ratio 1.0003830830524059
parameter name gc1.weight parameter value tensor([[ 0.2463]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-03 *
       [ 6.8104], device='cuda:0')
parameter name gc2.weight parameter value tensor([[-0.2454]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-05 *
       [ 8.5129], device='cuda:0')
epochs 20 loss 0.09179892428669145
epoch 0020 gcn2one_step_greedy  train av_ratio 1.002664576802508  validation av_ratio 1.000459699662887
parameter name gc1.weight parameter value tensor([[ 0.2703]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-03 *
       [ 4.9693], device='cuda:0')
parameter name gc2.weight parameter value tensor([[-0.2693]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-05 *
       [ 1.7166], device='cuda:0')
epochs 21 loss 0.06115458750944658
epoch 0021 gcn2one_step_greedy  train av_ratio 1.0022727272727274  validation av_ratio 1.000919399325774
parameter name gc1.weight parameter value tensor([[ 0.2792]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-03 *
       [ 4.7907], device='cuda:0')
parameter name gc2.weight parameter value tensor([[-0.2783]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-04 *
       [-1.0315], device='cuda:0')
epochs 22 loss 0.0677227515355252
epoch 0022 gcn2one_step_greedy  train av_ratio 1.003605015673981  validation av_ratio 0.999003984063745
parameter name gc1.weight parameter value tensor([[ 0.2854]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-02 *
       [ 1.7152], device='cuda:0')
parameter name gc2.weight parameter value tensor([[-0.2848]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [ 2.6456], device='cuda:0')
epochs 23 loss 0.06780367648767616
epoch 0023 gcn2one_step_greedy  train av_ratio 1.0032915360501569  validation av_ratio 0.9980079681274899
parameter name gc1.weight parameter value tensor([[ 0.2886]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-02 *
       [ 1.8899], device='cuda:0')
parameter name gc2.weight parameter value tensor([[-0.2882]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [ 3.8338], device='cuda:0')
epochs 24 loss 0.06220569305070889
epoch 0024 gcn2one_step_greedy  train av_ratio 1.0014890282131663  validation av_ratio 0.9994636837266319
parameter name gc1.weight parameter value tensor([[ 0.2829]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-03 *
       [ 3.4903], device='cuda:0')
parameter name gc2.weight parameter value tensor([[-0.2827]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-05 *
       [ 9.6163], device='cuda:0')
epochs 25 loss 0.05062137446951542
epoch 0025 gcn2one_step_greedy  train av_ratio 1.0  validation av_ratio 0.9955562365920932
parameter name gc1.weight parameter value tensor([[ 0.2704]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-03 *
       [ 1.9621], device='cuda:0')
parameter name gc2.weight parameter value tensor([[-0.2703]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-05 *
       [ 2.6536], device='cuda:0')
epochs 26 loss 0.06234511205153481
epoch 0026 gcn2one_step_greedy  train av_ratio 1.004858934169279  validation av_ratio 0.9985442844008581
parameter name gc1.weight parameter value tensor([[ 0.2685]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-03 *
       [ 1.8921], device='cuda:0')
parameter name gc2.weight parameter value tensor([[-0.2685]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-05 *
       [-1.3266], device='cuda:0')
epochs 27 loss 0.07163457565245945
epoch 0027 gcn2one_step_greedy  train av_ratio 1.0025862068965516  validation av_ratio 0.9990806006742261
parameter name gc1.weight parameter value tensor([[ 0.2860]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-02 *
       [ 1.7858], device='cuda:0')
parameter name gc2.weight parameter value tensor([[-0.2860]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-05 *
       [-6.3945], device='cuda:0')
epochs 28 loss 0.05319436570054137
epoch 0028 gcn2one_step_greedy  train av_ratio 1.0015673981191222  validation av_ratio 0.9988507508427827
parameter name gc1.weight parameter value tensor([[ 0.2885]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-03 *
       [ 3.3938], device='cuda:0')
parameter name gc2.weight parameter value tensor([[-0.2885]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-05 *
       [-8.6348], device='cuda:0')
epochs 29 loss 0.05737307695708349
epoch 0029 gcn2one_step_greedy  train av_ratio 1.002194357366771  validation av_ratio 1.0006129328838491
parameter name gc1.weight parameter value tensor([[ 0.2768]], device='cuda:0')
parameter name gc1.bias parameter value tensor(1.00000e-02 *
       [ 1.7049], device='cuda:0')
parameter name gc2.weight parameter value tensor([[-0.2768]], device='cuda:0')
parameter name gc2.bias parameter value tensor(1.00000e-06 *
       [-3.8366], device='cuda:0')
Training finished
Training time: 1181.1400
Elimination time: 18.7200
Heuristicone_step_greedy time: 934.3900
Dense 2 Sparce time: 6.9600
IO to cuda time: 4.1400
Model and Opt time: 45.1900
| Xavier Initialization
| Xavier Initialization
test stated
Traceback (most recent call last):
  File "test_pretrain.py", line 446, in <module>
    ratio, av_ratio, max_ratio, min_ratio, ratio_g2r, av_ratio_g2r, max_ratio_g2r, min_ratio_g2r = train_sl.test()
  File "/SCRATCH/liudefen/PycharmProjects/gnn/GraphRL/gcn/train_supervised_learning.py", line 82, in test
    q2_mindegree[i] = d_min
UnboundLocalError: local variable 'd_min' referenced before assignment
